---
output:
  html_document: default
  pdf_document: default
---

# NPS_Backcountry

Analysis of dayhike versus overnight hike Noise and Natural Sounds work for NPS/FAA.

Built from the `2016_2017_Analysis/Overnight/` directory on the Volpe project server.

All necessary code and data are provided to create the output reported in `Multi-day Dose-Response 2017-06-07.docx`.

To facilitate running this code locally, use RStudio and launch the code by double-clicking `NPS_Backcountry.Rproj`. This will ensure the working directory is set to the location of this project.

This version uses fixed-effect models, as an alternative to the mixed-effect models prsented in the report.

#### Compatibility

These scripts have been tested on Windows 10, R 3.6.2, with the latest version of RStudio (recommended but not required), as well as on Windows Server 2012R2, R 3.5.3, RStudio 1.2.1335.

# Data

#### Input 

Raw files by park, site, and survey are individual `.csv` files in the directory Data/Input.

#### Compiled

- ATMP2011_CompleteDose_Vars_dprime.csv

- DRMerged2011subset_dprime.csv

# Scripts

#### 1. `ATMP_2011DataProcess_Dprime.R`
This prepares the compiled data files from the original raw input files. Provided for completeness, not necessary to run since compiled data files are also provided.

#### 2. `RunModelScript_Manuscript_CoeffOnly_Overnight.R`
This is a master script which calls the multiple different types of individual modeling scripts, with different inputs depending on which combinations of predictors is used. 47 models are run.

To navigate among the different models being run, in RStudio use Code > Show Document Outline.

The output of this script is 94 files, with an output file containing the coefficients and p-values (`*_CoeffProbs.csv`) and model performance by AIC (`*_CoeffAIC.csv`) for each model.
Finally, this script runs a model comparison script which evaluates all models by AIC and selects the best model for each of the three levels of Annoy and Interfere responses.

Scripts called by this master script are the following:

- `ATMP_2011Overnight_LogRegPEn_Annoy_ACHR1HR2_CoeffOnly-nosurvey.R`
- `ATMP_2011Overnight_LogRegPEn_Annoy_ACHR1HR2_CoeffOnly.R`
- `ATMP_2011Overnight_LogRegPEn_ImpCP_Annoy_ACHR1HR2.R`
- `ATMP_2011Overnight_LogRegPEn_Interfere_ACHR1HR2_CoeffOnly-nosurvey.R`
- `ATMP_2011Overnight_LogRegPEn_Interfere_ACHR1HR2_CoeffOnly.R`
- `ATMP_2011Overnight_LogRegPEn_Interfere_CoeffOnly.R`
- `Model_Setup_Overnight.R`
- `Model_Selection_Overnight.R`

The script may take several minutes to complete.

Note that the model scripts have been changed to accomodate the fixed effect models of type:
`glm(response ~ Site + SiteType + dose_vars + mediating_vars, family = binomial(link="logit"))`

For example, one of the first models run looks at the response 'annoyed, somewhat or more' using this model structure:
`glm(Annoy_VorMore ~ Site + SiteType + SELAllAC + PTAudAllAC + PEnHelos + PEnProps + Survey + ImpCP_VorMore + SiteVisitBefore + AdultsOnly + WatchBirds, family = binomial(link="logit"))`


#### 3. Plotting and final tables

- `Plot_Overnight_Descriptors.R`
This script generates the descriptive tables and figures in the report. This is unchanged in the fixed-effect model version.

- `Plot_Run_Final_Overnight_Models.R`
This script generates the logistic curves from the best fit models for dayhike and overnight.
It also produces the inputs for the final model fit tables, tables 4 and 5 in the report. These are generated in the `tab_model()` commands for each of the six final models.

# Output

The contents of the output directory are all generated by these scripts. Meaning, you can delete them all and run the scripts as described here to generate them yourself.

The output include the following:

- Individual model coefficients and summary statistics in .csv format
- Best-fit final model summaries in .csv format
- Coefficients, confidence interval, and p-values for final best fit models in .html format
- A PDF of the annoyance and interference with natural quiet dose-response figures for backcountry visitors.
- Additional PDFs of descriptive figures for the report.
